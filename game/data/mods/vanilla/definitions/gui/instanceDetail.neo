Gui: gInstanceDetail {
	
	template = Text;
	layout = vertical;
	
	Script: new(instance) {
		->instance = instance;
	    ->background = "gui/back_stone01.png";
		
		// addGui(self, gVariables, self);
		
		->list = [];
		for(attribute : eachAttribute(->instance)) {
			->list += addGui(self, gAttribute, attribute, ->instance);
		}
		
		update();
	}
	
	Script: tick() {
		update();
	}
	
	Script: update() {
		->text = getName(->instance);
		
		if (->c++ % 100 == 0) {
			for(attribute : eachAttribute(->instance)) {
				found = false;
				for (a : ->list) {
					if (getAttId(a->attribute) == getAttId(attribute)) {
						found = true;
						break;
					}
				}
				if (!found) {
					->list += addGui(self, gAttribute, attribute, ->instance);
				}
			}
		}
	}
}

Gui: gText {

	template = Text;
	
	Script: new(text) {
		->text = text;
	}
}

Gui: gAttribute {

	template = Text;
	
	Script: new(attribute, instance) {
		->attribute = attribute;
		->instance = instance;
	    ->background = "gui/back_wood01.png";
		
		->text = attribute;
	}
	
	Script: tick() {
		value = getAttValue(->instance, getAttId(->attribute));
		->text = value;
		if (value == 0) { destroy(self); }
	}

	Script: click() {
		if (->flip = ! ->flip) {
			->background = "gui/back_wood01_pressed.png";
		} else {
			->background = "gui/back_wood01.png";
		}
	}
}

Gui: gVariables {

	template = Text;
	
	Script: new(target) {
		->target = target;
	}
	
	Script: tick() {
		clearGui(self);
		for (var : eachVariable(->target)) {
			addGui(self, gText, var);
		}
	}

}
